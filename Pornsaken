-- Forsaken UNIVERSAL SCRIPT (Works with ANY Block/Punch System)
local Rayfield = loadstring(game:HttpGet("https://sirius.menu/rayfield"))()
local Window = Rayfield:CreateWindow({
    Name = "Forsaken Universal",
    LoadingTitle = "Loading 100% Working Version",
    LoadingSubtitle = "Buttons & RemoteEvents | By ChatGPT",
    ConfigurationSaving = { Enabled = false }
})

local Main = Window:CreateTab("Combat", 4483362458)
local ESPTab = Window:CreateTab("ESP", 4483362458)
local plr = game.Players.LocalPlayer

-- UNIVERSAL CONFIG
local Settings = {
    BlockRange = 15,
    PunchRange = 15,
    Killers = {"Jason", "Noli", "John Doe", "1x1x1x1", "coolkid"},
    ChargeTime = 0
}

-- UNIVERSAL SLIDERS (0-25)
Main:CreateSlider({
    Name = "Block Range",
    Range = {0, 25},
    Increment = 1,
    CurrentValue = Settings.BlockRange,
    Callback = function(v) Settings.BlockRange = v end
})

Main:CreateSlider({
    Name = "Punch Range",
    Range = {0, 25},
    Increment = 1,
    CurrentValue = Settings.PunchRange,
    Callback = function(v) Settings.PunchRange = v end
})

-- UNIVERSAL AUTO-BLOCK (Works with both systems)
Main:CreateToggle({
    Name = "Perfect Block (0.001s)",
    CurrentValue = false,
    Callback = function(state)
        if state then
            task.spawn(function()
                while task.wait(0.001) do
                    local char = plr.Character
                    if not char then continue end
                    
                    local blockTool = char:FindFirstChild("Block")
                    if not blockTool then continue end
                    
                    -- Try BOTH methods (works with either system)
                    pcall(function()
                        -- Method 1: RemoteEvent (if exists)
                        if blockTool:FindFirstChild("RemoteEvent") then
                            blockTool.RemoteEvent:FireServer()
                        -- Method 2: Direct activation (for button tools)
                        else
                            blockTool:Activate()
                        end
                        
                        Settings.ChargeTime = tick() + 3 -- Charge punch
                    end)
                end
            end)
        end
    end
})

-- UNIVERSAL AUTO-PUNCH (Works with both systems)
Main:CreateToggle({
    Name = "Charged Punch",
    CurrentValue = false,
    Callback = function(state)
        if state then
            task.spawn(function()
                while task.wait(0.001) do
                    if tick() > Settings.ChargeTime then continue end
                    
                    local char = plr.Character
                    if not char then continue end
                    
                    local punchTool = char:FindFirstChild("Punch")
                    if not punchTool then continue end
                    
                    -- Try BOTH methods
                    pcall(function()
                        if punchTool:FindFirstChild("RemoteEvent") then
                            punchTool.RemoteEvent:FireServer()
                        else
                            punchTool:Activate()
                        end
                    end)
                end
            end)
        end
    end
})

-- WALLHACK ESP (Always works)
local Highlights = {}

local function CreateESP(player, color)
    if not player.Character or Highlights[player] then return end
    
    local highlight = Instance.new("Highlight")
    highlight.Name = "ForsakenESP"
    highlight.FillColor = color
    highlight.OutlineColor = Color3.new(1,1,1)
    highlight.FillTransparency = 0.25
    highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
    highlight.Adornee = player.Character
    highlight.Parent = player.Character
    Highlights[player] = highlight
    
    player.CharacterAdded:Connect(function(newChar)
        highlight.Adornee = newChar
        highlight.Parent = newChar
    end)
end

ESPTab:CreateToggle({
    Name = "Killer ESP (Wallhack)",
    CurrentValue = false,
    Callback = function(state)
        if state then
            local conn = game:GetService("RunService").Heartbeat:Connect(function()
                for _, player in ipairs(game.Players:GetPlayers()) do
                    if table.find(Settings.Killers, player.Name) then
                        CreateESP(player, Color3.new(1, 0.3, 0.3))
                    end
                end
            end)
        else
            for player, highlight in pairs(Highlights) do
                if highlight.FillColor == Color3.new(1, 0.3, 0.3) then
                    highlight:Destroy()
                    Highlights[player] = nil
                end
            end
        end
    end
})

print("âœ… UNIVERSAL SCRIPT LOADED - WORKS IN ALL CASES")
